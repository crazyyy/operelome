function goAway(t){return!0}function showPhoto(t,e){return cur.Rpc.callMethod("showBox","al_photos.php?"+ajx2q({act:"photo_box",photo:t,wall_owner:t.split("_")[0],widget:1,list:e,widget_width:654,widget:1}),{height:window.outerHeight||screen.availHeight||768,width:window.outerWidth||screen.availWidth||1028}),!1}function mentionOver(t,e){return!1}function mentionClick(t,e,o){return!0}function showWiki(t){return!0}function showVideo(t,e){return cur.Rpc.callMethod("showBox","al_video.php?"+ajx2q({act:"video_box",video:t,list:e,wall_owner:t.split("_")[0],widget_width:654,widget:1,module:cur.module||"_alcommunity"}),{height:window.outerHeight||screen.availHeight||768,width:window.outerWidth||screen.availWidth||1028}),!1}function showFriends(t){return t>0?!0:(cur.Rpc.callMethod("showBox","al_page.php?"+ajx2q({act:"show_members_box",gid:-t,tab:"friends",widget:1}),{height:495,width:432}),!1)}function showInlineVideo(videoId,listId,options,ev,thumb){if(checkEvent(ev))return!0;if(window.mvcur&&mvcur.mvShown)return showVideo(videoId,listId,options,ev);options=options||{},options.params=options.params||{act:"show_inline",video:videoId,list:listId,autoplay:options.autoplay?1:0,module:options.module||cur.module||"_acm"};var h=thumb.clientHeight,w=thumb.clientWidth,btn=geByClass1("video_play_inline",thumb,"div");return!trim(options.params.module)&&window.nav&&extend(options.params,{_nol:JSON.stringify(nav.objLoc)}),extend(options.params,{width:w,height:h}),options.onDone=function(title,html,js,opts){revertLastInlineVideo(),hide(thumb);var videoWrap=ce("div",{id:"page_video_inline_wrap"+videoId,className:"page_video_inline_wrap",innerHTML:html},{width:w,height:h}),videoBg=ge("video_background"+videoId);_videoLastInlined=[videoWrap,thumb],thumb.parentNode.appendChild(videoWrap),videoBg&&setStyle(geByTag1("img",videoBg),{width:w,height:h});try{eval("(function () {"+js+"})();")}catch(e){debugLog("video inline error",e.message,e.stack,e,js)}var _n=window.Notifier,_a=window.audioPlayer;_n&&setTimeout(function(){_n.lcSend("video_start")},0),_a&&_a.player&&!_a.player.paused()&&(_a.pauseTrack(),_a.pausedByVideo=1)},options.showProgress=function(){addClass(btn,"video_play_inline_loading")},options.hideProgress=function(){removeClass(btn,"video_play_inline_loading")},ajax.post("al_video.php",options.params,options),!1}function revertLastInlineVideo(){window._videoLastInlined&&(re(_videoLastInlined[0]),show(_videoLastInlined[1]),_videoLastInlined=!1)}var Community={init:function(){cur.Rpc=new fastXDM.Client({onInit:function(){setTimeout(function(){Community.resizeWidget()},500)},authorised:function(t){var e=location.href;e=-1!=e.indexOf("fieldText=")?e.replace(/fieldText=.+?(&|$)/,"fieldText="+winToUtf(ge("commentFiled").getValue())+""):e+"&fieldText="+winToUtf(ge("commentFiled").getValue()),-1!=e.indexOf("autoLogin=1")&&(e=e.replace("autoLogin=1","autoLogin=0")),location.href=e},unauthorised:function(t){var e=location.href;-1!=e.indexOf("autoLogin=0")?e=e.replace("autoLogin=0","autoLogin=1"):e+="&autoLogin=1",cur.Rpc.callMethod("auth"),location.href=e},mouseMove:function(t){cur.mouseMove(t)},mouseUp:function(){cur.mouseUp()}},{safe:!0}),cur.mainDiv=ge("main"),Community.resizeWidget(),window.wall&&(wall.postTooltip=function(){}),setTimeout(function(){Community.resizeWidget()},0)},resizeWidget:function(){if(onBodyResize(!0),cur.mainDiv&&cur.Rpc){var t=getSize(cur.mainDiv)[1];cur.Rpc.callMethod("resize",t)}},sendStateEvent:function(t){t?cur.Rpc.callMethod("publish","widgets.groups.joined"):cur.Rpc.callMethod("publish","widgets.groups.leaved")},sendChangeState:function(t,e,o,i){Community.sendStateEvent(t);var n=ge("hiddenDomain");n?domain=n.value:domain="",ajax.post("/widget_community.php",{act:"a_change_state",state:t,oid:e,hash:cur.hash,domain:domain,is_event:i?1:0},{onDone:function(t,e){o&&o(t,e)},onFail:function(){}})},changeGroupState:function(t,e){return cur.isAdmin&&!confirm(cur.isAdminLang)?!1:cur.noAuth?(Community.widgetAuth(),window.gotSession=function(o){-1==o&&(setTimeout(function(){location.reload()},1e3),location.href=location.href+"&1"),o&&ajax.post("/widget_community.php",{act:"a_get_info",oid:cur.oid},{onDone:function(o){o.hash&&(cur.noAuth=!1,cur.justAuth=!0,cur.hash=o.hash,cur.can_subscribe=o.can_subscribe,o.subscribed?addClass(cur.join_community,"community_checked"):removeClass(cur.join_community,"community_checked"),Community.changeGroupState(t,e))}})},!1):t&&!cur.justAuth?(Community.subscribeBox(t,function(){animate(ge("community_anim_row"),{marginLeft:0},200);var o=ge("members_count");o&&(o.innerHTML=cur.count_in),Community.sendStateEvent(t),e()}),!0):(!cur.justAuth&&ge("community_anim_row")&&(t?(animate(ge("community_anim_row"),{marginLeft:0},200),ge("members_count").innerHTML=cur.count_in):(animate(ge("community_anim_row"),{marginLeft:-cur.mWidth},200),ge("members_count").innerHTML=cur.count_out)),Community.sendChangeState(t,cur.oid),e(),!0)},changeEventState:function(t,e,o){return cur.noAuth?(Community.widgetAuth(),window.gotSession=function(i){cur.noAuth=!1,ajax.post("/widget_community.php",{act:"a_get_info",oid:cur.oid},{onDone:function(i){i.hash&&(cur.hash=i.hash,cur.can_subscribe=i.can_subscribe,Community.changeEventState(t,e,o))}})},!1):t>0&&!cur.justAuth?(Community.subscribeBox(t,function(e){-1==t?o.innerHTML=cur.linkCont:unlockButton(o);var i=ge("community_event_join");i&&(i.innerHTML=e),Community.sendStateEvent(t),Community.resizeWidget()},!0),!0):(-1==t?(cur.linkCont=o.innerHTML,o.innerHTML='<img src="/images/upload.gif" />'):lockButton(o),void Community.sendChangeState(t,cur.oid,function(e){-1==t?o.innerHTML=cur.linkCont:unlockButton(o),ge("community_event_join").innerHTML=e,Community.resizeWidget()},1))},widgetAuth:function(){function t(){window.activePopup.closed?window.gotSession(!0):setTimeout(t,1e3)}var e="undefined"!=typeof window.screenX?window.screenX:window.screenLeft,o="undefined"!=typeof window.screenY?window.screenY:window.screenTop,i="undefined"!=typeof window.outerWidth?window.outerWidth:document.body.clientWidth,n="undefined"!=typeof window.outerHeight?window.outerHeight:document.body.clientHeight-22,s="width=655,height=479,left="+parseInt(e+(i-655)/2,10)+",top="+parseInt(o+(n-479)/2.5,10);window.activePopup=window.open(location.protocol+"//oauth.vk.com/authorize?client_id=-1&redirect_uri=close.html&display=widget","vk_openapi",s),t()},subscribeBox:function(t,e,o){var i="undefined"!=typeof window.screenX?window.screenX:window.screenLeft,n="undefined"!=typeof window.screenY?window.screenY:window.screenTop,s="undefined"!=typeof window.outerWidth?window.outerWidth:document.body.clientWidth,r="undefined"!=typeof window.outerHeight?window.outerHeight:document.body.clientHeight-22,a="width=655,height=479,left="+parseInt(i+(s-655)/2,10)+",top="+parseInt(n+(r-479)/2.5,10);window.activePopup=window.open(location.protocol+"//"+location.host+"/widget_community.php?act=a_subscribe_box&oid="+cur.oid+"&state="+t+(o?"&is_event=1":""),"vk_subscribe",a),window.subscribedCallback=function(t){e(t)}},toggleStat:function(t,e){cur.statShown?(setStyle(ge("community_groups_main"),{height:"auto"}),hide("hide_stat"),show("show_stat"),show("community_content"),hide("stat_info"),setTimeout(Community.resizeWidget,0)):(cur.oldHeight=getSize("community_groups_main")[1],show("hide_stat"),hide("show_stat"),hide("community_content"),show("stat_info"),setTimeout(Community.resizeWidget,0),setTimeout(Community.resizeWidget,500),cur.statLoaded?setStyle(ge("community_groups_main"),{height:"auto"}):(setStyle(ge("community_groups_main"),{height:cur.oldHeight-8}),setStyle(ge("wcomments_progress"),{marginTop:cur.oldHeight/2-40}),ajax.post("/widget_community.php",{act:"a_get_stat",width:e,oid:t},{onDone:function(t){setStyle(ge("community_groups_main"),{height:"auto"}),cur.statLoaded=!0,ge("stat_info").innerHTML=t,setTimeout(Community.resizeWidget,0),setTimeout(Community.resizeWidget,500)}}))),cur.statShown=!cur.statShown},membersBox:function(t){cur.Rpc.callMethod("showBox","widget_community.php?act=members_box&oid="+t,{height:442,width:498})},subscribeGroupState:function(t,e){return ajax.post("/widget_community.php",{act:"a_subscribe",state:t,oid:e,hash:cur.hash},{onDone:function(t){},onFail:function(){return!0}}),!0},hideStat:function(t,e){hide("hide_stat"),show("show_stat"),show("community_content"),hide("stat_info"),setTimeout(Community.resizeWidget,0)},subscribeSimple:function(){Community.changeGroupState(1,function(){hide("subscribe_button"),show("unsubscribe_button"),cur.canSwitch&&(hide("community_friends"),show("community_like"))})},unsubscribeSimple:function(){Community.changeGroupState(0,function(){show("subscribe_button"),hide("unsubscribe_button"),cur.canSwitch&&(show("community_friends"),hide("community_like"))})},headerOver:function(t){if(cur.nameOutTimeout&&clearTimeout(cur.nameOutTimeout),!cur.headTween){var e=ge("wcommunity_name_cont");addClass(e,"wcommuinty_name_scrolling");var o=ge("wcommunity_name_anim"),i=getSize(o)[0]-getSize(e)[0];if(0>i)return!1;var n=40*i;cur.headTimeout&&clearTimeout(cur.headTimeout),cur.headTween=animate(o,{marginLeft:-i},{duration:n,transition:Fx.Transitions.linear,onComplete:function(){cur.headTimeout=setTimeout(function(){cur.headTween=animate(o,{marginLeft:0},{duration:n,transition:Fx.Transitions.linear,onComplete:function(){cur.headTween=!1,cur.headTimeout=setTimeout(Community.headerOver.pbind(t),1e3)}})},1e3)}})}},headerOut:function(t){var e=ge("wcommunity_name_cont");cur.headTimeout&&clearTimeout(cur.headTimeout),cur.nameOutTimeout=setTimeout(function(){var t=ge("wcommunity_name_anim");cur.headTween=animate(t,{marginLeft:0},200,function(){removeClass(e,"wcommuinty_name_scrolling"),cur.headTween=!1}),cur.headTimeout&&clearTimeout(cur.headTimeout)},50)},_eof:1};try{stManager.done("api/widgets/al_community.js")}catch(e){}window.gotSession=function(t){};var communityWall={postTooltip:function(t,e,o){if(!cur.viewAsBox){var i=geByClass("poll",t);return i.length&&cur.baseUrl&&(t.href=cur.baseUrl+"wall"+e),!0}},showMore:function(){if(cur.wallLoaded)return!1;if(cur.loadingMore)return void(cur.meedMore=!0);cur.loadingMore=!0,hide("wall_more_text"),show("wall_more_progress");var t={act:"load_more",offset:cur.offset,oid:cur.oid,wide:cur.wide,width:cur.width};cur.mode&&(t.mode=1),ajax.post("/widget_community.php",t,{onDone:function(t,e,o){cur.offset+=o,cur.offset>=e&&(cur.wallLoaded=!0,hide("wall_more_cont")),ge("page_wall_posts").appendChild(ce("div",{innerHTML:t})),Community.resizeWidget(),setTimeout(Community.resizeWidget,500),show("wall_more_text"),hide("wall_more_progress"),cur.loadingMore=!1,cur.meedMore&&(cur.meedMore=!1,setTimeout(function(){communityWall.showMore()},0)),cur.scrollbar&&cur.scrollbar.update()},onFail:function(){return!0}})}};!function(t){t.Scrollbar=function(e,o){this.obj=e=ge(e),this.options=o||{},setTimeout(function(){function i(e){return r.moveY?void 0:(addEvent(t.document,"mousemove",r.mouseMove),addEvent(t.document,"mouseup",r.mouseUp),r.moveY=e.screenY-(parseInt(r.inner.style.marginTop)||0),t.document.body.style.cursor="pointer",addClass(r.inner,"scrollbar_hovered"),o.startDrag&&o.startDrag(),r.isDown=!0,cancelEvent(e))}function n(t){var e=t.keyCode;switch(e){case 40:r.obj.scrollTop+=20;break;case 38:r.obj.scrollTop-=20;break;case 34:r.obj.scrollTop+=r.scrollHeight;break;case 33:r.obj.scrollTop-=r.scrollHeight;break;default:return!0}return r.update(!0),cancelEvent(t)}if(e){setStyle(e,{overflow:"hidden"});var s=getSize(e);s[0]<100&&o.width&&(s[0]=o.width-2),this.scrollHeight=s[1],this.scrollbar=ce("div",{className:"scrollbar_cont"}),setStyle(this.scrollbar,{right:"1px",left:"auto",height:s[1]+"px"}),this.inner=ce("div",{className:"scrollbar_inner"}),this.scrollbar.appendChild(this.inner),o.shadows&&(this.topShadowDiv=ce("div",{className:"scrollbar_top"}),this.bottomShadowDiv=ce("div",{className:"scrollbar_bottom",width:s[0]+"px"}),this.bottomShadowDiv.style.width=this.topShadowDiv.style.width=s[0]+"px",e.parentNode.insertBefore(this.topShadowDiv,e),e.parentNode.insertBefore(this.bottomShadowDiv,e.nextSibling)),e.parentNode.insertBefore(this.scrollbar,e),this.mouseMove=this._mouseMove.bind(this),this.mouseUp=this._mouseUp.bind(this);var r=this;this.mouseDown=i,addEvent(e,"mousewheel",this.wheel.bind(this)),addEvent(t,"DOMMouseScroll",this.wheel.bind(this)),addEvent(this.scrollbar,"mouseover",this.contOver.bind(this)),addEvent(this.scrollbar,"mouseout",this.contOut.bind(this)),addEvent(this.scrollbar,"mousedown",this.contDown.bind(this)),browser.safari_mobile&&(addEvent(e,"touchstart",function(t){cur.touchY=t.touches[0].pageY}),addEvent(e,"touchmove",function(t){var o=t.touches[0].pageY;return cur.touchDiff=cur.touchY-o,e.scrollTop+=cur.touchDiff,cur.touchY=o,e.scrollTop>0&&r.shown!==!1?(r.update(!0),cancelEvent(t)):void 0}),addEvent(e,"touchend",function(){cur.animateInt=setInterval(function(){cur.touchDiff=.9*cur.touchDiff,cur.touchDiff<1&&cur.touchDiff>-1?clearInterval(cur.animateInt):(e.scrollTop+=cur.touchDiff,r.update(!0))},0)})),addEvent(this.inner,"mousedown",i),addEvent(t,"keydown",n),this.contHeight()<=this.scrollHeight?hide(this.bottomShadowDiv):this.bottomShadow=!0,this.inited=!0,this.update(!0)}}.bind(this),0)},Scrollbar.prototype.contOver=function(){this.isOut=!1,addClass(this.scrollbar,"scrollbar_c_overed")},Scrollbar.prototype.contOut=function(){this.isOut=!0,this.isDown||removeClass(this.scrollbar,"scrollbar_c_overed")},Scrollbar.prototype.contDown=function(t){var e=t.offsetY-this.innerHeight/2+5,o=this.scrollHeight-this.innerHeight,i=Math.floor((this.contHeight()-this.scrollHeight)*Math.min(1,e/o));this.obj.scrollTop=i,this.update(!0),this.mouseDown(t)},t.Scrollbar.prototype._mouseMove=function(t){return this.obj.scrollTop=Math.floor((this.contHeight()-this.scrollHeight)*Math.min(1,(t.screenY-this.moveY)/(this.scrollHeight-26))),this.update(!0),!1},t.Scrollbar.prototype._mouseUp=function(e){return this.moveY=!1,this.isDown=!1,this.isOut&&this.contOut(),removeEvent(t.document,"mousemove",this.mouseMove),removeEvent(t.document,"mouseup",this.mouseUp),t.document.body.style.cursor="default",removeClass(this.inner,"scrollbar_hovered"),this.options.stopDrag&&this.options.stopDrag(),!1},t.Scrollbar.prototype.wheel=function(t){t||(t=window.event);var e=0;t.wheelDeltaY||t.wheelDelta?e=(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&(e=10*-t.detail);var o=this.obj.scrollTop;return this.obj.scrollTop-=e,o!=this.obj.scrollTop&&this.shown!==!1?(this.update(!0),!1):void 0},t.Scrollbar.prototype.contHeight=function(){if(this.contHashCash)return this.contHashCash;for(var t=this.obj.childNodes,e=0,o=t.length;o--;)e+=t[o].offsetHeight||0;return this.contHashCash=e,e},t.Scrollbar.prototype.update=function(t,e){if(this.inited){if(!t&&(this.contHashCash=!1,this.moveY))return!0;if(e){var o=getSize(this.obj);this.scrollHeight=o[1]}var i=this.contHeight();if(i<=this.scrollHeight)return hide(this.inner),void(this.shown=!1);this.shown||(show(this.inner),this.shown=!0);var n=Math.min(1,this.obj.scrollTop/(i-this.scrollHeight));n>0!=this.topShadow&&this.topShadowDiv&&((this.topShadow?hide:show)(this.topShadowDiv),this.topShadow=!this.topShadow),1>n!=this.bottomShadow&&this.bottomShadowDiv&&((this.bottomShadow?hide:show)(this.bottomShadowDiv),this.bottomShadow=!this.bottomShadow),this.innerHeight=Math.max(40,Math.floor(this.scrollHeight*this.scrollHeight/i)),this.inner.style.height=this.innerHeight+"px",i-this.obj.scrollTop<2*this.scrollHeight&&this.options.more(),this.inner.style.marginTop=Math.floor((this.scrollHeight-this.innerHeight-4)*n+2)+"px"}}}(window),window._videoLastInlined=!1;